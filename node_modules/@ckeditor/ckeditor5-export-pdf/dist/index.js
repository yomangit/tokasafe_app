/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x2553dd,Plugin as _0x157333}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x147a0e,MenuBarMenuListItemButtonView as _0x600470,SpinnerView as _0x20a284,Notification as _0x5de0d7}from'@ckeditor/ckeditor5-ui/dist/index.js';function a(){const _0x1caec1=[],_0x222073=[];for(const _0x548c02 of Array['from'](document['styleSheets'])){if(_0x548c02['ownerNode']['hasAttribute']('data-cke')){for(const _0x2b3b97 of Array['from'](_0x548c02['cssRules']))-0x1!==_0x2b3b97['cssText']['indexOf']('.ck-content')?_0x1caec1['push'](_0x2b3b97['cssText']):-0x1!==_0x2b3b97['cssText']['indexOf'](':root')&&_0x222073['push'](_0x2b3b97['cssText']);}}return _0x1caec1['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x222073,..._0x1caec1]['join']('\x20')['trim']();}function d(_0x4243c7,_0x4ef17d){const t=_0x4243c7['t'];switch(_0x4ef17d){case'Export\x20to\x20PDF':return t('Export\x20to\x20PDF');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.');case'PDF\x20export\x20started':return t('PDF\x20export\x20started');case'PDF\x20export\x20failed':return t('PDF\x20export\x20failed');case'PDF\x20export\x20successful':return t('PDF\x20export\x20successful');case'Exporting\x20PDF\x20document':return t('Exporting\x20PDF\x20document');default:return _0x4ef17d;}}class e extends _0x2553dd{constructor(_0x348912){super(_0x348912),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x1a9af1={}){const _0x5d25be=this['editor'],_0x2398e5=_0x1a9af1['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x29f61a=_0x1a9af1['dataCallback']||(_0x1497ca=>_0x1497ca['data']['get']()),_0x506fad=_0x5d25be['plugins']['get']('ExportPdf'),_0x280a1d=_0x1a9af1['token']||_0x506fad['_token'];return this['isBusy']=!0x0,this['refresh'](),function(_0x9c68aa){if(!_0x9c68aa)return new Promise(_0x5ac53f=>_0x5ac53f(''));const _0x327f33=[];for(const _0xb14be0 of _0x9c68aa)'EDITOR_STYLES'!==_0xb14be0?_0x327f33['push'](window['fetch'](_0xb14be0)['then'](_0x2ea5c3=>_0x2ea5c3['text']())):_0x327f33['push'](a());return Promise['all'](_0x327f33)['then'](_0x2c4bd9=>_0x2c4bd9['join']('\x20')['trim']());}(_0x1a9af1['stylesheets']||['EDITOR_STYLES'])['then'](async _0xc08864=>{if(_0x5d25be['ui']['ariaLiveAnnouncer']['announce'](d(_0x5d25be['locale'],'PDF\x20export\x20started')),_0x5d25be['plugins']['has']('MergeFields')){_0x1a9af1['converterOptions']||(_0x1a9af1['converterOptions']={});const _0x445b22=_0x5d25be['plugins']['get']('MergeFieldsEditing'),_0x41d773=_0x445b22['previewMode'],{prefix:_0x2aa766,suffix:_0x81ad15}=_0x5d25be['config']['get']('mergeFields'),_0xcad9cb={'prefix':_0x2aa766,'suffix':_0x81ad15,'data':{}};if('$labels'===_0x41d773){for(const _0x500b08 of _0x445b22['getMergeFieldsIds']())_0xcad9cb['data'][_0x500b08]=_0x2aa766+_0x445b22['getLabel'](_0x500b08)+_0x81ad15;}else{const _0x11853b='$defaultValues'===_0x41d773?_0x445b22['getDefaultValues']():_0x445b22['getDataSetValues'](_0x41d773,!0x0);for(const _0x3d3250 of Object['entries'](_0x11853b)){const [_0x1cc9a3,_0x34b548]=_0x3d3250;_0xcad9cb['data'][_0x1cc9a3]=null!==_0x34b548?_0x34b548:_0x445b22['getLabel'](_0x1cc9a3);}}_0x1a9af1['converterOptions']['merge_fields']=_0xcad9cb;}const _0x1e60c9={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x5d25be['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x29f61a(_0x5d25be)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0xc08864,'options':_0x1a9af1['converterOptions']},_0x5279b1={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x280a1d?{'Authorization':_0x280a1d['value']}:null,'x-cs-app-id':_0x1a9af1['appID']||'cke5'},'body':JSON['stringify'](_0x1e60c9)};return window['fetch'](_0x2398e5,_0x5279b1)['then'](_0x13e9ff=>{if(0xc8!==_0x13e9ff['status'])throw _0x13e9ff;return _0x13e9ff['blob']();})['then'](_0x34646a=>{_0x5d25be['ui']['ariaLiveAnnouncer']['announce'](d(_0x5d25be['locale'],'PDF\x20export\x20successful'));const _0x41cc64='function'==typeof _0x1a9af1['fileName']?_0x1a9af1['fileName']():_0x1a9af1['fileName'];this['_downloadFile'](_0x34646a,_0x41cc64||'document.pdf');});})['catch'](_0x26b576=>{const _0x32fffd=_0x5d25be['plugins']['get']('Notification');throw _0x5d25be['ui']['ariaLiveAnnouncer']['announce'](d(_0x5d25be['locale'],'PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x32fffd['showWarning'](d(_0x5d25be['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x26b576;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x1dc30e,_0x2c5574){const _0x6cfc16=document['createElement']('a');_0x6cfc16['href']=window['URL']['createObjectURL'](_0x1dc30e),_0x6cfc16['download']=_0x2c5574,_0x6cfc16['click'](),_0x6cfc16['remove']();}}class s extends _0x157333{static get['pluginName'](){return'ExportPdfUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x4dac6b=this['editor'];_0x4dac6b['ui']['componentFactory']['add']('exportPdf',()=>{const _0x4d254f=this['_createButton'](_0x147a0e),_0x4ae5d9=_0x4dac6b['commands']['get']('exportPdf');return _0x4d254f['set']({'tooltip':!0x0}),_0x4d254f['bind']('isOn')['to'](_0x4ae5d9,'isBusy'),_0x4d254f;}),_0x4dac6b['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0x600470));}['_createButton'](_0x57e7c9){const _0x5e1e96=this['editor'],_0x36fd98=_0x5e1e96['config']['get']('exportPdf')||{},_0x1ab21d=_0x5e1e96['commands']['get']('exportPdf'),_0x1705ae=new _0x57e7c9(_0x5e1e96['locale']),_0x3d5372=new _0x20a284();return _0x1705ae['children']['add'](_0x3d5372),_0x3d5372['bind']('isVisible')['to'](_0x1ab21d,'isBusy'),_0x1705ae['iconView']['bind']('isVisible')['to'](_0x1ab21d,'isBusy',_0x5b61bb=>!_0x5b61bb),_0x1705ae['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M19\x204.5\x2014\x200H3v6.5h1.5v-5h8v5h5V11H19V4.5ZM14\x202l3.3\x203H14V2Z\x22/><path\x20d=\x22m12.452\x2018.5\x201.25\x201.5H3v-3h1.5v1.5h7.952Z\x22/><path\x20d=\x22M19.826\x2016.843a.75.75\x200\x201\x200-1.152-.96L17.5\x2017.29V13H16v4.29l-1.174-1.408a.75.75\x200\x201\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22M1.63\x2014.24V12.3h.88c.66\x200\x201.14-.15\x201.46-.45.32-.3.48-.71.48-1.24\x200-.52-.15-.91-.44-1.2C3.7\x209.15\x203.28\x209\x202.69\x209H0v5.24h1.63Zm.4-3h-.4v-1.17h.46c.3\x200\x20.5.05.62.17.1.11.16.25.16.42\x200\x20.16-.06.3-.19.41-.13.11-.34.16-.66.16l.01.01Zm5.7\x203c.28\x200\x20.6-.05.96-.14.26-.07.5-.21.73-.42.22-.2.4-.47.53-.77.12-.31.19-.75.19-1.3\x200-.37-.04-.7-.13-1.02a2.3\x202.3\x200\x200\x200-.42-.84c-.19-.24-.43-.43-.72-.56C8.57\x209.06\x208.2\x209\x207.72\x209h-2.4v5.24H7.73Zm-.4-1.19h-.4v-2.86h.4c.43\x200\x20.73.1.91.3.18.2.27.59.27\x201.14\x200\x20.42-.04.73-.12.91a.76.76\x200\x200\x201-.34.4c-.14.07-.38.11-.72.11Zm5.3\x201.2V12.1h2.02v-1.06h-2.03v-.91H15V9h-4v5.24h1.62l.01.01Z\x22/></svg>\x0a'}),_0x1705ae['bind']('isEnabled')['to'](_0x1ab21d,'isEnabled'),_0x1705ae['bind']('label')['to'](_0x1ab21d,'isBusy',_0x420797=>d(_0x5e1e96['locale'],_0x420797?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x1705ae,'execute',()=>{_0x5e1e96['execute']('exportPdf',_0x36fd98),_0x5e1e96['editing']['view']['focus']();}),_0x1705ae;}}class o extends _0x157333{['_token'];static get['pluginName'](){return'ExportPdf';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x5de0d7,s];}['init'](){const _0x123908=this['editor'],_0x4b50e8=_0x123908['config']['get']('exportPdf')||{};_0x123908['commands']['add']('exportPdf',new e(_0x123908));const _0x59f90c=_0x123908['plugins']['get']('CloudServices');!0x1===_0x4b50e8['tokenUrl']?this['_token']=null:_0x4b50e8['tokenUrl']?_0x59f90c['registerTokenUrl'](_0x4b50e8['tokenUrl'])['then'](_0x24dc4e=>{this['_token']=_0x24dc4e;}):this['_token']=_0x59f90c['token'];}}export{o as ExportPdf};