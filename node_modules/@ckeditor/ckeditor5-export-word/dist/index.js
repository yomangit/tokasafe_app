/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x55c6f5,Plugin as _0x974807}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x5af375,MenuBarMenuListItemButtonView as _0x3e43ae,SpinnerView as _0x1474df,Notification as _0x11ce1f}from'@ckeditor/ckeditor5-ui/dist/index.js';import{logWarning as _0x453feb}from'@ckeditor/ckeditor5-utils/dist/index.js';function f(){const _0x267eb4=[],_0x221561=[];for(const _0x443a7c of Array['from'](document['styleSheets'])){if(_0x443a7c['ownerNode']['hasAttribute']('data-cke')){for(const _0x20a2dc of Array['from'](_0x443a7c['cssRules']))-0x1!==_0x20a2dc['cssText']['indexOf']('.ck-content')?_0x267eb4['push'](_0x20a2dc['cssText']):-0x1!==_0x20a2dc['cssText']['indexOf'](':root')&&_0x221561['push'](_0x20a2dc['cssText']);}}return _0x267eb4['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x221561,..._0x267eb4]['join']('\x20')['trim']();}function a(_0x286aa1,_0x2792af={}){const _0x4ffb75=_0x286aa1['plugins']['has']('Users'),_0x12e5be=_0x286aa1['plugins']['has']('CommentsRepository'),_0x182a67=_0x286aa1['plugins']['has']('TrackChanges'),_0x18970b=_0x2792af;if(_0x4ffb75&&_0x12e5be){const _0x1f7e71=function(_0x17854d){const _0x27baea={};if(!_0x17854d['length'])return _0x27baea;for(const _0x54030b of _0x17854d)_0x54030b['comments']['map'](_0x128011=>{void 0x0===_0x27baea[_0x54030b['id']]&&(_0x27baea[_0x54030b['id']]=[]),_0x27baea[_0x54030b['id']]['push']({'author':_0x128011['author']['name'],'content':_0x128011['content'],'created':_0x128011['createdAt'],'is_resolved':_0x54030b['isResolved']});});return _0x27baea;}(_0x286aa1['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));Object['keys'](_0x1f7e71)['length']&&(_0x18970b['comments']=_0x1f7e71);}if(_0x4ffb75&&_0x182a67){const _0x2c81af=_0x286aa1['plugins']['get']('TrackChanges'),_0x42e033=_0x286aa1['plugins']['get']('Users'),_0x16d274=function(_0x133456,_0x367b14){const _0x442fd9={};if(!_0x133456['length']||!_0x367b14['length'])return _0x442fd9;for(const {id:_0x5b620e,createdAt:_0x4bed27,authorId:_0x1f6d20,attributes:_0x38b6d9}of _0x133456){const _0x31cc99=_0x38b6d9&&_0x38b6d9['@external'],_0x410b7b=_0x31cc99?_0x31cc99['authorName']:_0x367b14['get'](_0x1f6d20)['name'];_0x442fd9[_0x5b620e]={'author':_0x410b7b,'created':_0x4bed27};}return _0x442fd9;}(_0x2c81af['getSuggestions']({'toJSON':!0x0}),_0x42e033['users']);Object['keys'](_0x16d274)['length']&&(_0x18970b['suggestions']=_0x16d274);}return(_0x18970b['suggestions']||_0x18970b['comments'])&&(_0x18970b['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone']),_0x18970b;}function m(_0x418fae,_0x31b50b={}){const _0x3968d7=_0x418fae['plugins']['has']('Users'),_0x43ba98=_0x418fae['plugins']['has']('CommentsRepository'),_0x2ebb63=_0x418fae['plugins']['has']('TrackChanges'),_0x3f5c12=_0x418fae['plugins']['has']('MergeFields'),_0x504e99=_0x418fae['locale']['contentLanguage'],_0x235031=_0x31b50b,_0x3272bf={};if(_0x235031['document']=_0x235031['document']||{},_0x235031['document']['language']=_0x235031['document']['language']||_0x504e99,_0x3968d7&&_0x43ba98){const _0x5001d3=function(_0x1faf56){const _0x157470=[];if(!_0x1faf56['length'])return _0x157470;for(const _0x137464 of _0x1faf56){const _0x5c6ae5=_0x137464['comments']['map'](_0x45985d=>({'author':_0x45985d['author']['name'],'content':_0x45985d['content'],'created_at':_0x45985d['createdAt']}));_0x157470['push']({'thread_id':_0x137464['id'],'is_resolved':_0x137464['isResolved'],'comments':_0x5c6ae5});}return _0x157470;}(_0x418fae['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));_0x5001d3['length']&&(_0x3272bf['comment_threads']=_0x5001d3);}if(_0x3968d7&&_0x2ebb63){const _0x41c0c2=_0x418fae['plugins']['get']('TrackChanges'),_0x174f79=_0x418fae['plugins']['get']('Users'),_0x3f2545=function(_0x23f954,_0x2704a1){if(!_0x23f954['length']||!_0x2704a1['length'])return[];return _0x23f954['map'](({id:_0x57cae7,createdAt:_0x8a35a8,authorId:_0x5eba1e,attributes:_0x4f8faf})=>{const _0x2e6b74=_0x4f8faf&&_0x4f8faf['@external'];return{'id':_0x57cae7,'author':_0x2e6b74?_0x2e6b74['authorName']:_0x2704a1['get'](_0x5eba1e)['name'],'created_at':_0x8a35a8};});}(_0x41c0c2['getSuggestions']({'toJSON':!0x0}),_0x174f79['users']);_0x3f2545['length']&&(_0x3272bf['suggestions']=_0x3f2545);}if(_0x3f5c12){const _0x29782e=_0x418fae['plugins']['get']('MergeFieldsEditing'),_0x4d4f8a=_0x29782e['previewMode'],{prefix:_0x10c8d7,suffix:_0x5200ad}=_0x418fae['config']['get']('mergeFields');if(_0x235031['merge_fields']={'prefix':_0x10c8d7,'suffix':_0x5200ad},'$labels'!==_0x4d4f8a){_0x235031['merge_fields']['data']={};const _0x68f946='$defaultValues'===_0x4d4f8a?_0x29782e['getDefaultValues']():_0x29782e['getDataSetValues'](_0x4d4f8a,!0x0);for(const _0x53f5a9 of Object['entries'](_0x68f946)){const [_0x25fcf7,_0x16a22c]=_0x53f5a9;_0x235031['merge_fields']['data'][_0x25fcf7]=null!==_0x16a22c?_0x16a22c:_0x29782e['getLabel'](_0x25fcf7);}}}return(_0x3272bf['comment_threads']||_0x3272bf['suggestions'])&&(_0x235031['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone'],_0x235031['collaboration_features']=_0x3272bf),_0x235031;}function p(_0x4aba67,_0x2c4eae){const t=_0x4aba67['t'];switch(_0x2c4eae){case'Export\x20to\x20Word':return t('Export\x20to\x20Word');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.');case'Word\x20document\x20export\x20started':return t('Word\x20document\x20export\x20started');case'Word\x20document\x20export\x20failed':return t('Word\x20document\x20export\x20failed');case'Word\x20document\x20export\x20successful':return t('Word\x20document\x20export\x20successful');case'Exporting\x20Word\x20document':return t('Exporting\x20Word\x20document');default:return _0x2c4eae;}}const h=['orientation','margin_top','margin_right','margin_bottom','margin_left','format','header','footer','comments','suggestions'];class e extends _0x55c6f5{constructor(_0x56b1e4){super(_0x56b1e4),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x12ddf3={}){const _0x19cdd4=this['editor'],_0x546470=_0x12ddf3['version']||0x2,_0x4b10e5=0x1===_0x546470,_0x5191b4=_0x12ddf3['converterUrl']||(_0x4b10e5?'https://docx-converter.cke-cs.com/v1/convert':'https://docx-converter.cke-cs.com/v2/convert/html-docx'),_0x10de0f=_0x12ddf3['converterOptions']||{},_0x3fb8b9=_0x19cdd4['plugins']['get']('ExportWord'),_0x8c2a77=_0x12ddf3['token']||_0x3fb8b9['_token'],_0x38cb7f=!0x0===_0x10de0f['auto_pagination'],_0x533ee3=_0x12ddf3['dataCallback']||(_0x230c86=>_0x230c86['data']['get']({'pagination':_0x38cb7f}));return 0x2===_0x546470&&function(_0x31593e){for(const _0x5cfc73 of h)if(void 0x0!==_0x31593e[_0x5cfc73])return!0x0;return!0x1;}(_0x10de0f)&&_0x453feb('export-word-v1-api-is-deprecated'),this['isBusy']=!0x0,this['refresh'](),function(_0x4a5397){if(!_0x4a5397)return new Promise(_0x2eddb7=>_0x2eddb7(''));const _0x26eff8=[];for(const _0x546b94 of _0x4a5397)'EDITOR_STYLES'!==_0x546b94?_0x26eff8['push'](window['fetch'](_0x546b94)['then'](_0x17da30=>_0x17da30['text']())):_0x26eff8['push'](f());return Promise['all'](_0x26eff8)['then'](_0x4a6e33=>_0x4a6e33['join']('\x20')['trim']());}(_0x12ddf3['stylesheets']||['EDITOR_STYLES'])['then'](async _0x1d3160=>{_0x19cdd4['ui']['ariaLiveAnnouncer']['announce'](p(_0x19cdd4['locale'],'Word\x20document\x20export\x20started'));const _0x457e13=await _0x533ee3(_0x19cdd4),_0x4323b7={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x19cdd4['locale']['contentLanguageDirection']+'\x22>'+_0x457e13+'</div>','css':_0x1d3160,[_0x4b10e5?'options':'config']:{..._0x10de0f,..._0x4b10e5?a(_0x19cdd4,_0x10de0f):m(_0x19cdd4,_0x10de0f)}},_0x54310e={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x8c2a77?{'Authorization':_0x8c2a77['value']}:null},'body':JSON['stringify'](_0x4323b7)};return window['fetch'](_0x5191b4,_0x54310e)['then'](_0x38d2dd=>{if(0xc8!==_0x38d2dd['status'])throw _0x38d2dd;return _0x38d2dd['blob']();})['then'](_0x58fcfe=>{_0x19cdd4['ui']['ariaLiveAnnouncer']['announce'](p(_0x19cdd4['locale'],'Word\x20document\x20export\x20successful'));const _0x190936='function'==typeof _0x12ddf3['fileName']?_0x12ddf3['fileName']():_0x12ddf3['fileName'];this['_downloadFile'](_0x58fcfe,_0x190936||'document.docx');});})['catch'](_0x250432=>{const _0x43e21d=_0x19cdd4['plugins']['get']('Notification');throw _0x19cdd4['ui']['ariaLiveAnnouncer']['announce'](p(_0x19cdd4['locale'],'Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x43e21d['showWarning'](p(_0x19cdd4['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x250432;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x3975d7,_0x376f38){const _0x45bfe1=document['createElement']('a');_0x45bfe1['href']=window['URL']['createObjectURL'](_0x3975d7),_0x45bfe1['download']=_0x376f38,_0x45bfe1['click'](),_0x45bfe1['remove']();}}class o extends _0x974807{static get['pluginName'](){return'ExportWordUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x43d1a7=this['editor'];_0x43d1a7['ui']['componentFactory']['add']('exportWord',()=>{const _0x10a049=_0x43d1a7['commands']['get']('exportWord'),_0x155fb3=this['_createButton'](_0x5af375);return _0x155fb3['set']({'tooltip':!0x0}),_0x155fb3['bind']('isOn')['to'](_0x10a049,'isBusy'),_0x155fb3;}),_0x43d1a7['ui']['componentFactory']['add']('menuBar:exportWord',()=>this['_createButton'](_0x3e43ae));}['_createButton'](_0x2cc81e){const _0x5cc825=this['editor'],_0x2ddbbe=_0x5cc825['config']['get']('exportWord')||{},_0xd7bcb1=_0x5cc825['commands']['get']('exportWord'),_0xe1041d=new _0x2cc81e(_0x5cc825['locale']),_0x42cd52=new _0x1474df();return _0xe1041d['children']['add'](_0x42cd52),_0x42cd52['bind']('isVisible')['to'](_0xd7bcb1,'isBusy'),_0xe1041d['iconView']['bind']('isVisible')['to'](_0xd7bcb1,'isBusy',_0x16c81a=>!_0x16c81a),_0xe1041d['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M17.826\x2016.843a.75.75\x200\x200\x200-1.152-.96L15.5\x2017.29V12H14v5.29l-1.174-1.408a.75.75\x200\x200\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22m14\x200\x205\x204.5v9.741a2.737\x202.737\x200\x200\x200-1.5-.617V6.5h-5v-5h-8v3H3V0h11Zm0\x202v3h3.3L14\x202Z\x22/><path\x20d=\x22M3\x2017.5h6.746c.1.22.23.429.391.623l.731.877H3v-1.5Z\x22/><path\x20d=\x22M8.5\x206a1.5\x201.5\x200\x200\x201\x201.493\x201.356L10\x207.5v7a1.5\x201.5\x200\x200\x201-1.356\x201.493L8.5\x2016h-7a1.5\x201.5\x200\x200\x201-1.493-1.356L0\x2014.5v-7a1.5\x201.5\x200\x200\x201\x201.356-1.493L1.5\x206h7ZM7.483\x208.795l-.042.088-.986\x202.534-.947-2.528-.043-.092a.601.601\x200\x200\x200-1.042.008l-.042.093-.883\x202.465-.937-2.475-.042-.089a.6.6\x200\x200\x200-1.107.42l.027.093\x201.514\x204\x20.044.092a.6.6\x200\x200\x200\x201.041-.01l.041-.092.88-2.458.925\x202.467.046.096a.6.6\x200\x200\x200\x201.032\x200l.043-.09\x201.554-4\x20.028-.093a.6.6\x200\x200\x200-1.104-.43v.001Z\x22/></svg>\x0a'}),_0xe1041d['bind']('isEnabled')['to'](_0xd7bcb1,'isEnabled'),_0xe1041d['bind']('label')['to'](_0xd7bcb1,'isBusy',_0x5a39c0=>p(_0x5cc825['locale'],_0x5a39c0?'Exporting\x20Word\x20document':'Export\x20to\x20Word')),this['listenTo'](_0xe1041d,'execute',()=>{_0x5cc825['execute']('exportWord',_0x2ddbbe),_0x5cc825['editing']['view']['focus']();}),_0xe1041d;}}class s extends _0x974807{['_token'];static get['pluginName'](){return'ExportWord';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x11ce1f,o];}['init'](){const _0x363603=this['editor'],_0x19c66a=_0x363603['config']['get']('exportWord')||{};_0x363603['commands']['add']('exportWord',new e(_0x363603));const _0x3a8f45=_0x363603['plugins']['get']('CloudServices');!0x1===_0x19c66a['tokenUrl']?this['_token']=null:_0x19c66a['tokenUrl']?_0x3a8f45['registerTokenUrl'](_0x19c66a['tokenUrl'])['then'](_0x5deb04=>{this['_token']=_0x5deb04;}):this['_token']=_0x3a8f45['token'];}}export{s as ExportWord};